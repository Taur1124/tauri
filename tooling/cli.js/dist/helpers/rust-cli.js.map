{"version":3,"sources":["webpack://tauri/webpack/universalModuleDefinition","webpack://tauri/../cli.rs/Cargo.toml","webpack://tauri/./src/helpers/download-binary.ts","webpack://tauri/./src/helpers/logger.ts","webpack://tauri/./src/helpers/rust-cli.ts","webpack://tauri/./src/helpers/spawn.ts","webpack://tauri/external \"chalk\"","webpack://tauri/external \"cross-spawn\"","webpack://tauri/external \"fs\"","webpack://tauri/external \"got\"","webpack://tauri/external \"ms\"","webpack://tauri/external \"path\"","webpack://tauri/external \"stream\"","webpack://tauri/external \"util\"","webpack://tauri/webpack/bootstrap","webpack://tauri/webpack/startup"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;ACVA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,C;;;;;;;;;;;AC5Ga;AACb;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA;AACA,aAAa,6BAA6B,0BAA0B,aAAa,EAAE,qBAAqB;AACxG,gBAAgB,qDAAqD,oEAAoE,aAAa,EAAE;AACxJ,sBAAsB,sBAAsB,qBAAqB,GAAG;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,kCAAkC,SAAS;AAC3C,kCAAkC,WAAW,UAAU;AACvD,yCAAyC,cAAc;AACvD;AACA,6GAA6G,OAAO,UAAU;AAC9H,gFAAgF,iBAAiB,OAAO;AACxG,wDAAwD,gBAAgB,QAAQ,OAAO;AACvF,8CAA8C,gBAAgB,gBAAgB,OAAO;AACrF;AACA,iCAAiC;AACjC;AACA;AACA,SAAS,YAAY,aAAa,OAAO,EAAE,UAAU,WAAW;AAChE,mCAAmC,SAAS;AAC5C;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,sBAAsB,GAAG,mBAAmB;AAC5C,+BAA+B,mBAAO,CAAC,sBAAQ;AAC/C,aAAa,mBAAO,CAAC,kBAAM;AAC3B,2BAA2B,mBAAO,CAAC,cAAI;AACvC,4BAA4B,mBAAO,CAAC,gBAAK;AACzC,6BAA6B,mBAAO,CAAC,kBAAM;AAC3C;AACA;AACA;AACA,uBAAuB,mBAAO,CAAC,wDAA4B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA,sBAAsB;;;;;;;;;;;;ACpJT;AACb;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,8BAA8B,mBAAO,CAAC,oBAAO;AAC7C,2BAA2B,mBAAO,CAAC,cAAI;AACvC;AACA,eAAe;AACf,2BAA2B,+BAA+B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;AC3BY;AACb;AACA;AACA;AACA;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA;AACA,aAAa,6BAA6B,0BAA0B,aAAa,EAAE,qBAAqB;AACxG,gBAAgB,qDAAqD,oEAAoE,aAAa,EAAE;AACxJ,sBAAsB,sBAAsB,qBAAqB,GAAG;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,kCAAkC,SAAS;AAC3C,kCAAkC,WAAW,UAAU;AACvD,yCAAyC,cAAc;AACvD;AACA,6GAA6G,OAAO,UAAU;AAC9H,gFAAgF,iBAAiB,OAAO;AACxG,wDAAwD,gBAAgB,QAAQ,OAAO;AACvF,8CAA8C,gBAAgB,gBAAgB,OAAO;AACrF;AACA,iCAAiC;AACjC;AACA;AACA,SAAS,YAAY,aAAa,OAAO,EAAE,UAAU,WAAW;AAChE,mCAAmC,SAAS;AAC5C;AACA;AACA;AACA,oDAAoD,QAAQ;AAC5D;AACA;AACA;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,oBAAoB;AACpB,WAAW,mBAAO,CAAC,cAAI;AACvB,aAAa,mBAAO,CAAC,kBAAM;AAC3B,cAAc,mBAAO,CAAC,uCAAS;AAC/B,wBAAwB,mBAAO,CAAC,2DAAmB;AACnD;AACA;AACA;AACA;AACA,IAAI,mBAAO,CAAC,wDAA4B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,4BAA4B;AAC5E,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,IAAwC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,6BAA6B;AAC5E;AACA,SAAS;AACT,KAAK;AACL;AACA,oBAAoB;;;;;;;;;;;;AChHP;AACb;AACA;AACA;AACA;AACA,4CAA4C;AAC5C;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,iBAAiB,GAAG,aAAa;AACjC,oCAAoC,mBAAO,CAAC,gCAAa;AACzD,+BAA+B,mBAAO,CAAC,yCAAU;AACjD,8BAA8B,mBAAO,CAAC,oBAAO;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;;;;;;;;;;;AC/DjB,mC;;;;;;;;;;;ACAA,yC;;;;;;;;;;;ACAA,gC;;;;;;;;;;;ACAA,iC;;;;;;;;;;;ACAA,gC;;;;;;;;;;;ACAA,kC;;;;;;;;;;;ACAA,oC;;;;;;;;;;;ACAA,kC;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;UCtBA;UACA;UACA;UACA","file":"helpers/rust-cli.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tauri\"] = factory();\n\telse\n\t\troot[\"tauri\"] = factory();\n})(this, function() {\nreturn ","module.exports    = {\n\t\"workspace\": {},\n\t\"package\": {\n\t\t\"name\": \"tauri-cli\",\n\t\t\"version\": \"1.0.0-beta.5\",\n\t\t\"authors\": [\n\t\t\t\"Tauri Programme within The Commons Conservancy\"\n\t\t],\n\t\t\"edition\": \"2018\",\n\t\t\"categories\": [\n\t\t\t\"gui\",\n\t\t\t\"web-programming\"\n\t\t],\n\t\t\"license\": \"Apache-2.0 OR MIT\",\n\t\t\"homepage\": \"https://tauri.studio\",\n\t\t\"repository\": \"https://github.com/tauri-apps/tauri\",\n\t\t\"description\": \"Command line interface for building Tauri apps\",\n\t\t\"include\": [\n\t\t\t\"src/\",\n\t\t\t\"/templates\",\n\t\t\t\"MergeModules/\",\n\t\t\t\"*.json\",\n\t\t\t\"*.rs\"\n\t\t]\n\t},\n\t\"bin\": [\n\t\t{\n\t\t\t\"name\": \"cargo-tauri\",\n\t\t\t\"path\": \"src/main.rs\"\n\t\t}\n\t],\n\t\"dependencies\": {\n\t\t\"clap\": {\n\t\t\t\"version\": \"3.0.0-beta.2\",\n\t\t\t\"features\": [\n\t\t\t\t\"yaml\"\n\t\t\t]\n\t\t},\n\t\t\"anyhow\": \"1.0\",\n\t\t\"tauri-bundler\": {\n\t\t\t\"version\": \"1.0.0-beta.3\",\n\t\t\t\"path\": \"../bundler\"\n\t\t},\n\t\t\"colored\": \"2.0\",\n\t\t\"once_cell\": \"1.8\",\n\t\t\"serde\": {\n\t\t\t\"version\": \"1.0\",\n\t\t\t\"features\": [\n\t\t\t\t\"derive\"\n\t\t\t]\n\t\t},\n\t\t\"serde_json\": \"1.0\",\n\t\t\"serde_with\": \"1.9\",\n\t\t\"notify\": \"4.0\",\n\t\t\"shared_child\": \"0.3\",\n\t\t\"toml_edit\": \"0.2\",\n\t\t\"json-patch\": \"0.2\",\n\t\t\"schemars\": \"0.8\",\n\t\t\"toml\": \"0.5\",\n\t\t\"valico\": \"3.6\",\n\t\t\"handlebars\": \"4.1\",\n\t\t\"include_dir\": \"0.6\",\n\t\t\"minisign\": \"0.6\",\n\t\t\"base64\": \"0.13.0\",\n\t\t\"ureq\": \"2.1\",\n\t\t\"os_info\": \"3.0\",\n\t\t\"semver\": \"1.0\",\n\t\t\"regex\": \"1.5\",\n\t\t\"lazy_static\": \"1\",\n\t\t\"libc\": \"0.2\",\n\t\t\"terminal_size\": \"0.1\",\n\t\t\"unicode-width\": \"0.1\",\n\t\t\"tempfile\": \"3\",\n\t\t\"zeroize\": \"1.3\"\n\t},\n\t\"target\": {\n\t\t\"cfg(windows)\": {\n\t\t\t\"dependencies\": {\n\t\t\t\t\"winapi\": {\n\t\t\t\t\t\"version\": \"0.3\",\n\t\t\t\t\t\"features\": [\n\t\t\t\t\t\t\"winbase\",\n\t\t\t\t\t\t\"winuser\",\n\t\t\t\t\t\t\"consoleapi\",\n\t\t\t\t\t\t\"processenv\",\n\t\t\t\t\t\t\"wincon\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t\"encode_unicode\": \"0.3\"\n\t\t\t}\n\t\t},\n\t\t\"cfg(target_os = \\\"linux\\\")\": {\n\t\t\t\"dependencies\": {\n\t\t\t\t\"heck\": \"0.3\"\n\t\t\t}\n\t\t}\n\t},\n\t\"build-dependencies\": {\n\t\t\"schemars\": \"0.8\",\n\t\t\"serde\": {\n\t\t\t\"version\": \"1.0\",\n\t\t\t\"features\": [\n\t\t\t\t\"derive\"\n\t\t\t]\n\t\t},\n\t\t\"serde_json\": \"1.0\",\n\t\t\"serde_with\": \"1.9\"\n\t}\n}","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.downloadRustup = exports.downloadCli = void 0;\r\nvar stream_1 = __importDefault(require(\"stream\"));\r\nvar util_1 = require(\"util\");\r\nvar fs_1 = __importDefault(require(\"fs\"));\r\nvar got_1 = __importDefault(require(\"got\"));\r\nvar path_1 = __importDefault(require(\"path\"));\r\nvar pipeline = util_1.promisify(stream_1.default.pipeline);\r\n// Webpack reads the file at build-time, so this becomes a static var\r\n// eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-var-requires, @typescript-eslint/no-unsafe-member-access\r\nvar tauriCliManifest = require('../../../cli.rs/Cargo.toml');\r\nvar downloads = {};\r\nfunction downloadBinaryRelease(tag, asset, outPath) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var url, removeDownloadedCliIfNeeded;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    url = \"https://github.com/tauri-apps/binary-releases/releases/download/\" + tag + \"/\" + asset;\r\n                    removeDownloadedCliIfNeeded = function () {\r\n                        try {\r\n                            if (!(url in downloads)) {\r\n                                // eslint-disable-next-line security/detect-non-literal-fs-filename\r\n                                fs_1.default.unlinkSync(outPath);\r\n                            }\r\n                        }\r\n                        finally {\r\n                            process.exit();\r\n                        }\r\n                    };\r\n                    // on exit, we remove the `tauri-cli` file if the download didn't complete\r\n                    process.on('exit', removeDownloadedCliIfNeeded);\r\n                    process.on('SIGINT', removeDownloadedCliIfNeeded);\r\n                    process.on('SIGTERM', removeDownloadedCliIfNeeded);\r\n                    process.on('SIGHUP', removeDownloadedCliIfNeeded);\r\n                    process.on('SIGBREAK', removeDownloadedCliIfNeeded);\r\n                    // TODO: Check hash of download\r\n                    // eslint-disable-next-line @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access, security/detect-non-literal-fs-filename\r\n                    return [4 /*yield*/, pipeline(got_1.default.stream(url), fs_1.default.createWriteStream(outPath)).catch(function (e) {\r\n                            try {\r\n                                // eslint-disable-next-line security/detect-non-literal-fs-filename\r\n                                fs_1.default.unlinkSync(outPath);\r\n                            }\r\n                            catch (_a) { }\r\n                            throw e;\r\n                        })\r\n                        // eslint-disable-next-line security/detect-object-injection\r\n                    ];\r\n                case 1:\r\n                    // TODO: Check hash of download\r\n                    // eslint-disable-next-line @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access, security/detect-non-literal-fs-filename\r\n                    _a.sent();\r\n                    // eslint-disable-next-line security/detect-object-injection\r\n                    downloads[url] = true;\r\n                    // eslint-disable-next-line security/detect-non-literal-fs-filename\r\n                    fs_1.default.chmodSync(outPath, 448);\r\n                    console.log('Download Complete');\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction downloadCli() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var version, platform, extension, outPath;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    version = tauriCliManifest.package.version;\r\n                    platform = process.platform;\r\n                    if (platform === 'win32') {\r\n                        platform = 'windows';\r\n                    }\r\n                    else if (platform === 'linux') {\r\n                        platform = 'linux';\r\n                    }\r\n                    else if (platform === 'darwin') {\r\n                        platform = 'macos';\r\n                    }\r\n                    else {\r\n                        throw Error('Unsupported platform');\r\n                    }\r\n                    extension = platform === 'windows' ? '.exe' : '';\r\n                    outPath = path_1.default.join(__dirname, \"../../bin/tauri-cli\" + extension);\r\n                    console.log('Downloading Rust CLI...');\r\n                    return [4 /*yield*/, downloadBinaryRelease(\"tauri-cli-v\" + version, \"tauri-cli_\" + platform + extension, outPath)];\r\n                case 1:\r\n                    _a.sent();\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.downloadCli = downloadCli;\r\nfunction downloadRustup() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var assetName;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    assetName = process.platform === 'win32' ? 'rustup-init.exe' : 'rustup-init.sh';\r\n                    console.log('Downloading Rustup...');\r\n                    return [4 /*yield*/, downloadBinaryRelease('rustup', assetName, path_1.default.join(__dirname, \"../../bin/\" + assetName))];\r\n                case 1: return [2 /*return*/, _a.sent()];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.downloadRustup = downloadRustup;\r\n","\"use strict\";\r\n// Copyright 2019-2021 Tauri Programme within The Commons Conservancy\r\n// SPDX-License-Identifier: Apache-2.0\r\n// SPDX-License-Identifier: MIT\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar chalk_1 = __importDefault(require(\"chalk\"));\r\nvar ms_1 = __importDefault(require(\"ms\"));\r\nvar prevTime;\r\nexports.default = (function (banner, color) {\r\n    if (color === void 0) { color = chalk_1.default.green; }\r\n    return function (msg) {\r\n        var curr = +new Date();\r\n        var diff = curr - (prevTime || curr);\r\n        prevTime = curr;\r\n        if (msg) {\r\n            console.log(\r\n            // TODO: proper typings for color and banner\r\n            // eslint-disable-next-line @typescript-eslint/restrict-template-expressions, @typescript-eslint/no-unsafe-call\r\n            \" \" + color(String(banner)) + \" \" + msg + \" \" + chalk_1.default.green(\"+\" + ms_1.default(diff)));\r\n        }\r\n        else {\r\n            console.log();\r\n        }\r\n    };\r\n});\r\n","\"use strict\";\r\n// Copyright 2019-2021 Tauri Programme within The Commons Conservancy\r\n// SPDX-License-Identifier: Apache-2.0\r\n// SPDX-License-Identifier: MIT\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArray = (this && this.__spreadArray) || function (to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.runOnRustCli = void 0;\r\nvar fs_1 = require(\"fs\");\r\nvar path_1 = require(\"path\");\r\nvar spawn_1 = require(\"./spawn\");\r\nvar download_binary_1 = require(\"./download-binary\");\r\nvar currentTauriCliVersion = function () {\r\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\r\n    var tauriCliManifest = \r\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\r\n    require('../../../cli.rs/Cargo.toml');\r\n    return tauriCliManifest.package.version;\r\n};\r\nfunction runOnRustCli(command, args) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var targetPath, targetCliPath, resolveCb, rejectCb, pid, promise, onClose, cliPath, localCliPath;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    targetPath = path_1.resolve(__dirname, '../..');\r\n                    targetCliPath = path_1.join(targetPath, 'bin/tauri-cli' + (process.platform === 'win32' ? '.exe' : ''));\r\n                    promise = new Promise(function (resolve, reject) {\r\n                        resolveCb = resolve;\r\n                        rejectCb = function () { return reject(new Error()); };\r\n                    });\r\n                    onClose = function (code, pid) {\r\n                        if (code === 0) {\r\n                            resolveCb();\r\n                        }\r\n                        else {\r\n                            rejectCb();\r\n                        }\r\n                    };\r\n                    if (!fs_1.existsSync(targetCliPath)) return [3 /*break*/, 1];\r\n                    pid = spawn_1.spawn(targetCliPath, __spreadArray(['tauri', command], args), process.cwd(), onClose);\r\n                    return [3 /*break*/, 4];\r\n                case 1:\r\n                    if (!(process.env.NODE_ENV === 'production')) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, download_binary_1.downloadCli()];\r\n                case 2:\r\n                    _a.sent();\r\n                    pid = spawn_1.spawn(targetCliPath, __spreadArray(['tauri', command], args), process.cwd(), onClose);\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    if (fs_1.existsSync(path_1.resolve(targetPath, '../bundler'))) {\r\n                        cliPath = path_1.resolve(targetPath, '../cli.rs');\r\n                        spawn_1.spawnSync('cargo', ['build', '--release'], cliPath);\r\n                        localCliPath = path_1.resolve(targetPath, '../cli.rs/target/release/cargo-tauri');\r\n                        pid = spawn_1.spawn(localCliPath, __spreadArray(['tauri', command], args), process.cwd(), onClose);\r\n                    }\r\n                    else {\r\n                        spawn_1.spawnSync('cargo', [\r\n                            'install',\r\n                            '--root',\r\n                            targetPath,\r\n                            'tauri-cli',\r\n                            '--version',\r\n                            currentTauriCliVersion()\r\n                        ], process.cwd());\r\n                        pid = spawn_1.spawn(targetCliPath, __spreadArray(['tauri', command], args), process.cwd(), onClose);\r\n                    }\r\n                    _a.label = 4;\r\n                case 4: return [2 /*return*/, { pid: pid, promise: promise }];\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.runOnRustCli = runOnRustCli;\r\n","\"use strict\";\r\n// Copyright 2019-2021 Tauri Programme within The Commons Conservancy\r\n// SPDX-License-Identifier: Apache-2.0\r\n// SPDX-License-Identifier: MIT\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.spawnSync = exports.spawn = void 0;\r\nvar cross_spawn_1 = __importDefault(require(\"cross-spawn\"));\r\nvar logger_1 = __importDefault(require(\"./logger\"));\r\nvar chalk_1 = __importDefault(require(\"chalk\"));\r\nvar log = logger_1.default('app:spawn');\r\nvar warn = logger_1.default('app:spawn', chalk_1.default.red);\r\n/*\r\n  Returns pid, takes onClose\r\n */\r\nvar spawn = function (cmd, params, cwd, onClose) {\r\n    var _a;\r\n    log(\"Running \\\"\" + cmd + \" \" + params.join(' ') + \"\\\"\");\r\n    log();\r\n    // TODO: move to execa?\r\n    var runner = cross_spawn_1.default(cmd, params, {\r\n        stdio: 'inherit',\r\n        cwd: cwd,\r\n        env: process.env\r\n    });\r\n    runner.on('close', function (code) {\r\n        var _a;\r\n        log();\r\n        if (code) {\r\n            // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\r\n            log(\"Command \\\"\" + cmd + \"\\\" failed with exit code: \" + code);\r\n        }\r\n        // eslint-disable-next-line @typescript-eslint/prefer-optional-chain\r\n        onClose && onClose(code !== null && code !== void 0 ? code : 0, (_a = runner.pid) !== null && _a !== void 0 ? _a : 0);\r\n    });\r\n    return (_a = runner.pid) !== null && _a !== void 0 ? _a : 0;\r\n};\r\nexports.spawn = spawn;\r\n/*\r\n  Returns nothing, takes onFail\r\n */\r\nvar spawnSync = function (cmd, params, cwd, onFail) {\r\n    log(\"[sync] Running \\\"\" + cmd + \" \" + params.join(' ') + \"\\\"\");\r\n    log();\r\n    var runner = cross_spawn_1.default.sync(cmd, params, {\r\n        stdio: 'inherit',\r\n        cwd: cwd\r\n    });\r\n    // eslint-disable-next-line @typescript-eslint/prefer-nullish-coalescing\r\n    if (runner.status || runner.error) {\r\n        warn();\r\n        // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\r\n        warn(\"\\u26A0\\uFE0F  Command \\\"\" + cmd + \"\\\" failed with exit code: \" + runner.status);\r\n        if (runner.status === null) {\r\n            warn(\"\\u26A0\\uFE0F  Please globally install \\\"\" + cmd + \"\\\"\");\r\n        }\r\n        // eslint-disable-next-line @typescript-eslint/prefer-optional-chain\r\n        onFail && onFail();\r\n        process.exit(1);\r\n    }\r\n};\r\nexports.spawnSync = spawnSync;\r\n","module.exports = require(\"chalk\");;","module.exports = require(\"cross-spawn\");;","module.exports = require(\"fs\");;","module.exports = require(\"got\");;","module.exports = require(\"ms\");;","module.exports = require(\"path\");;","module.exports = require(\"stream\");;","module.exports = require(\"util\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(\"./src/helpers/rust-cli.ts\");\n"],"sourceRoot":""}